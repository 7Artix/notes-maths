
# 10.1 多元函数的基本概念

## `定义85` $平面点集$

> 在坐标平面上具有某种性质 $P$ 的点, 称为<font color=red><b>平面点集</b></font>, 记作:

$$
E=
\left\{
\begin{pmatrix}
x \\ y
\end{pmatrix} | 
\begin{pmatrix}
x \\ y
\end{pmatrix} 具有某种性质P
\right\}
$$

> 若不局限在平面上, 可以拓展为:

$$
E=
\left\{
\begin{pmatrix}
x_1 \\ x_2 \\ \vdots \\ x_n
\end{pmatrix} | 
\begin{pmatrix}
x_1 \\ x_2 \\ \vdots \\ x_n
\end{pmatrix} 具有某种性质P
\right\}
$$

> 上述点集也就是<font color=red><b>向量组</b></font>.


## `定义86` $多元函数$

> 设 $D$ 是 $\mathbb{R}^2$ 的一个非空子集, 称映射 $f:D\to\mathbb{R}$ 为定义在 $D$ 上的<font color=red><b>二元函数</b></font>, 通常记作:

$$
z=f(x,y),\quad (x,y)\in D
$$

> 若引入二维向量 $\boldsymbol{x} = \begin{pmatrix} x \\ y \end{pmatrix}$ , 则上式可以记作:

$$
z=f(\boldsymbol{x}),\quad \boldsymbol{x}\in D
$$

> 其中平面点集 $D$ 称为该函数的<font color=red><b>定义域</b></font>, $x$ 和 $y$ (或 $\boldsymbol{x}$ ) 称为<font color=red><b>自变量</b></font>, $z$ 称为<font color=red><b>因变量</b></font>.


## `定义87` $邻域$

> 设 $P_0(x_0,y_0)$ 是 $xOy$ 面上的一点, $\delta$ 是某正数, 与 $P_0$ 点距离小于 $\delta$ 的 $P(x,y)$ 的全体, 称为 $P_0$ 点的<font color=red><b>邻域</b></font>, 记作 $U(P_0,\delta)$ , 若不关心 $\delta$ , 也可以简记为 $U(P_0)$ , 即:

$$
U(P_0,\delta) = U(P_0) = \{P | \ ||\overrightarrow{P_0P}||<\delta\} = 
\left\{
\begin{pmatrix}
x \\ y
\end{pmatrix} | 
(x-x_0)^2+(y-y_0)^2<\delta^2
\right\}
$$

> 从邻域 $U(P_0,\delta)$ 中去掉 $P_0$ 就是<font color=red><b>去心邻域</b></font> $\mathring{U}(P_0,\delta)$ , 若不关心 $\delta$ , 也可以简记为 $\mathring{U}(P_0)$ , 即:

$$
\mathring{U}(P_0,\delta) = \mathring{U}(P_0) = \{P | \ 0<||\overrightarrow{P_0P}||<\delta\} = 
\left\{
\begin{pmatrix}
x \\ y
\end{pmatrix} | 
0<(x-x_0)^2+(y-y_0)^2<\delta^2
\right\}
$$

邻域就是以 $P_0$ 为圆心, 半径为 $\delta$ , **不包含圆周**的圆. 该定义可以拓展到更高维度上.


## `定义88` $内点,外点和边界$

> 任意一点 $P\in\mathbb{R}^2$ 和任意一个点集 $E\subset\mathbb{R}^2$ 的关系必然是以下三种之一:

- <font color=red><b>内点</b></font>: 若存在 $P$ 的某邻域 $U(P)$ , 使得 $U(P)\subset E$ , 则称 $P$ 为 $E$ 的内点, 必有 $P\in E$ .
- <font color=red><b>外点</b></font>: 若存在 $P$ 的某邻域 $U(P)$ , 使得 $U(P) \cap E = \varnothing$ , 则称 $P$ 为 $E$ 的外点, 必有 $P\notin E$ .
- <font color=red><b>边界点</b></font>: 若存在 $P$ 的任意邻域内既含有属于 $E$ 的点, 又含有不属于 $E$ 的点, 则称 $P$ 为 $E$ 的边界点.


## `定义89` $边界$

> $E$ 的所有边界点的全体称为 $E$ 的<font color=red><b>边界</b></font>, 记作 $\partial E$ .


## `定义90` $开集和闭集$

> 设 $\partial E$ 为某点集 $E$ 的边界, 根据 $\partial E$ 与 $E$ 的关系,

- 若 $\partial E \cap E = \varnothing$ , 即边界 $\partial E$ 完全不属于 $E$ , 则称 $E$ 为<font color=red><b>开集</b></font> ( $Open \ set$ ).
- 若 $\partial E \subset E$ , 即边界 $\partial E$ 完全属于 $E$ , 则称 $E$ 为<font color=red><b>闭集</b></font> ( $Closed \ set$ ).
- 若 $\partial E$ 部分属于 $E$ , 则 $E$ 既非开集也非闭集.

空集既非开集也非闭集.


## `定义91` $连通集$

> 若点集 $E$ 的任何两点都可用折线联结起来, 且该折线上所有点都属于 $E$ , 则称 $E$ 为<font color=red><b>连通集</b></font>.


## `定义92` $开区域和闭区域$

> 连通的开集称为<font color=red><b>开区域</b></font>, 或简称为<font color=red><b>区域</b></font>; 
> 开区域连同其边界共同构成的点集称为<font color=red><b>闭区域</b></font>.

区域类似于数轴概念中的区间.

区域相较于开集和闭集重点区别在于是否**连通**, 需要注意, 两个闭集通过有限个点连接, 构成的整体点集并不是闭区域, 即:

$$
\begin{array}{c}
连通的开集 \implies 开区域 \\
连通的闭集 \ \centernot\implies \ 闭区域
\end{array}
$$


## `定义93` $有界集和无界集$

> 对于点集 $E$ , 若存在常数 $r$ 使得 $E\subset U(O,r)$ , 其中 $O$ 是原点, 则称 $E$ 为<font color=red><b>有界集</b></font> ( $Bounded \ set$ ), 否则称 $E$ 为<font color=red><b>无界集</b></font> ( $Unbounded \ set$ ).

表达的含义为, 如果有一个任意大半径的邻域可以包含点集 $E$ , 则 $E$ 有界, 邻域的中心点可以任取.


# 10.2 多元函数的极限和连续

## `定义94` $极限点$

> 若 $\forall \delta > 0$ , $P$ 点的去心邻域 $\mathring{U}(P,\delta)$ 内总有点集 $E$ 中的点, 则称 $P$ 点为 $E$ 的<font color=red><b>聚点</b></font> ( $Accumulation \ point$ ), 或称<font color=red><b>极限点</b></font> ( $Limit \ point$ ).

对于连续的数集, 例如去心邻域, 中心点本身就是聚点; 而对于非连续的数集, 聚点的任意小的邻域范围内要有无穷多个点.

聚点是极限存在的必要条件.


## `定义95` $二元函数的极限$

> 设二元函数 $f(P) = f(x,y)$ 的定义域为 $D$ ,  $P_0(x_0,y_0)$ 是 $D$ 的**聚点**, 若 $\forall \epsilon > 0$ , $\exists \delta > 0$ , $\forall P(x,y)\in D \cap \mathring{U}(P_0,\delta)$ , 有:

$$
|f(P)-L| = |f(x,y)-L| < \epsilon,\quad L\in \mathbb{R}
$$

> 则称 $L$ 为函数 $f(x,y)$ 当 $(x,y)\to(x_0,y_0)$ 时的极限, 即<font color=red><b>二元函数的极限</b></font>, 或称<font color=red><b>二重极限</b></font>, 记作:

$$
\lim_{(x,y)\to(x_0,y_0)}f(x,y)=L \quad 或 \quad
f(x,y)\to L \ \Big((x,y)\to(x_0,y_0)\Big)
$$

> 也记作:

$$
\lim_{P\to P_0}f(P) = L\quad 或 \quad
f(P)\to L \ (P\to P_0)
$$

> 若不存在这样的常数 $L$ , 则当 $(x,y)\to(x_0,y_0)$ 时, 函数 $f(x,y)$ 没有极限, 称函数 $f(x,y)$ <font color=red><b>发散</b></font>, 也称极限不存在.

注意, 自变量可以从不同的方向趋近于聚点. 若极限存在, 则必须从不同的方向趋近于聚点的极限值相同.


## `定义96` $连续$

> 对于二元函数 $f(x,y)$ :
- 若 $\displaystyle\lim_{(x,y)\to(x_0,y_0)}f(x,y) = f(x_0,y_0)$ , 则 $f(x,y)$ 在 $P_0(x_0,y_0)$ 点<font color=red><b>连续</b></font>.
- 若 $f(x,y)$ 在点集 $E$ 上的每一点都连续, 则称函数 $f(x,y)$ 是 $E$ 上的<font color=red><b>连续函数</b></font>.

由常数, 一元函数的基本初等函数经过有限次的四则运算和复合得到的多元函数是<font color=red><b>多元初等函数</b></font>, 多元初等函数在其定义区间上是**连续**的.


## `定理120` $多元函数的有界性与最大值最小值定理$

> 在有界闭区域 $D$ 上的多元连续函数, 必定在 $D$ 上有界, 且能取得其最大值和最小值.

与一元函数类似, 是说闭区间上的连续函数必有界.


## `定理121` $多元函数的介值定理$

> 在有界闭区域 $D$ 上的多元连续函数, 必可以取得介于最大值和最小值之间的任意值.

与一元函数的介值定理类似.


## `定义97` $多元函数的间断点$

> 设二元函数 $f(x,y)$ 的定义域为 $D$ , $P_0(x_0,y_0)$ 是 $D$ 的聚点. 若函数 $f(x,y)$ 在 $P_0(x_0,y_0)$ 点不连续, 则称 $P_0(x_0,y_0)$ 为函数 $f(x,y)$ 的<font color=red><b>间断点</b></font>.


# 10.3 偏导数, 偏微分和全微分

微分本质上就是线性近似中"**线性**"的概念.

$$
微分:
\left\{
\begin{array}{l}
曲线的微分(切线),\ 即可近似曲线的直线. \\
曲面的微分(切平面),\ 即可近似曲面的平面.
\end{array}
\right.
$$

寻找曲面微分的思路是: 使用某点处曲面包含的两条不重合的曲线, 分别得到两个曲线的微分, 根据曲线微分求出共平面即曲面微分. 
为了方便计算通常可以借助平行于 $x$ 轴和 $y$ 轴的曲线, 二者的微分不重合, 分别称为 $f(x,y)$ 在 $(x_0,y_0)$ 点对 $x$ 的偏微分和对 $y$ 的偏微分.

## `定义98` $偏导数$

> 若如下极限存在, 则称该极限为函数 $z=f(x,y)$ 在 $(x_0,y_0)$ 点<font color=red><b>对</b></font> $\color{red}x$ <font color=red><b>的偏导数</b></font>, 记作:

$$
\left. \frac{\partial z}{\partial x}\right|_{\begin{array}{l}x=x_0 \\[-4pt] y=y_0\end{array}} = 
\left. \frac{\partial f}{\partial x}\right|_{\begin{array}{l}x=x_0 \\[-4pt] y=y_0\end{array}} = 
\left. z_x \right|_{\begin{array}{l}x=x_0 \\[-4pt] y=y_0\end{array}} = 
f_x(x_0,y_0) = 
\lim_{h \to 0} \frac{f(x_0+h,y_0)-f(x_0,y_0)}{h}
$$

> 若如下极限存在, 则称该极限为函数 $z=f(x,y)$ 在 $(x_0,y_0)$ 点<font color=red><b>对</b></font> $\color{red}y$ <font color=red><b>的偏导数</b></font>, 记作:

$$
\left. \frac{\partial z}{\partial y}\right|_{\begin{array}{l}x=x_0 \\[-4pt] y=y_0\end{array}} = 
\left. \frac{\partial f}{\partial y}\right|_{\begin{array}{l}x=x_0 \\[-4pt] y=y_0\end{array}} = 
\left. z_y \right|_{\begin{array}{l}x=x_0 \\[-4pt] y=y_0\end{array}} = 
f_y(x_0,y_0) = 
\lim_{h \to 0} \frac{f(x_0,y_0+h)-f(x_0,y_0)}{h}
$$

> 上述两个极限也笼统地称为函数 $z=f(x,y)$ 在 $(x_0,y_0)$ 点的<font color=red><b>偏导数</b></font>.


若要根据偏导数求出全微分对应的平面解析式, 可以通过如下方式计算.

可以分别得到曲线微分在 $(x_0,y_0)$ 点处的方向向量:

$$
对x偏微分:
\boldsymbol{m} = 
\begin{pmatrix}
1 \\
0 \\
f_x(x_0,y_0)
\end{pmatrix},\quad
对y偏微分:
\boldsymbol{n} = 
\begin{pmatrix}
0 \\
1 \\
f_y(x_0,y_0)
\end{pmatrix}
$$

可以知道, 曲面微分的法向量是 $\boldsymbol{m}\times\boldsymbol{n}$ , 计算可得:

$$
\boldsymbol{m}\times\boldsymbol{n} = 
\begin{vmatrix}
\boldsymbol{i} & 1 & 0 \\
\boldsymbol{j} & 0 & 1 \\
\boldsymbol{k} & f_x(x_0,y_0) & f_y(x_0,y_0) \\
\end{vmatrix} = 
\begin{pmatrix}
-f_x(x_0,y_0) \\
-f_y(x_0,y_0) \\
1
\end{pmatrix}
$$

可以通过点法式方程表示全微分, 方程为:

$$
-f_x(x_0,y_0)\mathrm{d}x-f_y(x_0,y_0)\mathrm{d}y+\mathrm{d}z = 0
\implies
\mathrm{d}z = f_x(x_0,y_0)\mathrm{d}x+f_y(x_0,y_0)\mathrm{d}y
$$

注意, 上述方程的坐标系是平移到 $(x_0,y_0)$ 点下的, 而不是相对坐标原点的方程. 

偏导数本身也是函数, 可以对其进一步求偏导数, 所得结果称为<font color=red><b>二阶偏导数</b></font>. 根绝求导的次序不同, 有多种二阶偏导数. 二阶及二阶以上的偏导数统称为<font color=red><b>高阶偏导数</b></font>.
分别对不同自变量求偏导数的偏导数称为<font color=red><b>混合偏导数</b></font>, 例如:

$$
\frac{\partial}{\partial y}(\frac{\partial z}{\partial x}) = \frac{\partial^2 z}{\partial x \partial y} = f_{xy}(x,y)
$$

理解混合偏导数:
$f_x$ 是与 $x$ 平行方向上的偏微分斜率, 再对 $y$ 求偏导数, 得到的是在沿 $y$ 平行的方向变化的过程中, 偏微分斜率 $f_x$ 的变化率. 若 $f_{xy}=0$ 说明在沿 $y$ 平行的方向变化的过程中, $x$ 方向上的偏微分斜率没有变化.
普通的高阶偏导数也可以参照理解.


## `定理122` $施瓦茨定理$

也称**克莱罗定理**:

> 若函数 $f(x,y)$ 的两个二阶混合偏导数在区域 $D$ 内连续, 则:

$$
f_{xy}(x,y) = f_{yx}(x,y),\quad (x,y)\in D
$$

即二阶混合偏导在 $D$ 连续时, 混合偏导数与求偏导顺序无关.

对于更高阶的混合偏导数也有该定理.


# 10.4 全微分

## `定义99` $全微分$

> 设函数 $z=f(x,y)$ 在 $(x_0,y_0)$ 点的某邻域内有定义, 令:

$$
\Delta x = \mathrm{d}x = x-x_0,\quad
\Delta y = \mathrm{d}y = y-y_0
$$

> 若函数 $f(x,y)$ 在 $(x_0,y_0)$ 点的<font color=red><b>全增量</b></font>:

$$
\Delta z = f(x_0+\Delta x,y_0+ \Delta y) - f(x_0, y_0)
$$

> 可表示为:

$$
\Delta z = A\Delta x + B\Delta y + o(\rho)
$$

> 其中 $A$ , $B$ 不依赖于 $\Delta x$ 和 $\Delta y$ 而仅与 $x$ 和 $y$ 相关, 且:

$$
\rho = \sqrt{(\Delta x)^2+(\Delta y)^2}
$$

> 则称 $z = f(x,y)$ 在 $(x_0,y_0)$ 点<font color=red><b>可微分</b></font>, 而 $A\Delta x + B\Delta y$ 称为 $z=f(x,y)$ 在 $(x_0,y_0)$ 点的<font color=red><b>全微分</b></font>, 此时通常改写为 $A\mathrm{d}x+B\mathrm{d}y$ , 并记作 $\mathrm{d}z$ , 即:

$$
\mathrm{d}z=A\mathrm{d}x+B\mathrm{d}y
$$

定义中的 $\rho = \sqrt{(\Delta x)^2+(\Delta y)^2}$ 代表 $(x,y)$ 到 $(x_0,y_0)$ 的距离, 而 $o(\rho)$ 表示 $\displaystyle\lim_{\rho\to 0}o(\rho) = 0$ , 所以在 $(x,y)$ 点不断逼近 $(x_0,y_0)$ 时, 曲面 $\Delta z$ 和全微分 $\mathrm{d}z$ 之间的差值在缩小, 并趋于 $0$ . 

全微分是近似平面方案中最相似的, 因为是相切的平面. 对应存在<font color=red><b>切平面</b></font>和<font color=red><b>切点</b></font>.

一个在原点处不可微分的图像案例如下:

<p align="central">
<img src="https://matongxue.oss-cn-hangzhou.aliyuncs.com/attch/matex/8239/2025081209055637/1.png" width="70%">
</p>


## `定理123` $全微分的求解$

> 若函数 $z=f(x,y)$ 在 $(x_0,y_0)$ 点可微分, 则偏导数 $f_x(x_0,y_0)$ , $f_y(x_0,y_0)$ , 必定存在, 且 $z = f(x,y)$ 在点 $(x_0,y_0)$ 的全微分为:

$$
\mathrm{d}z = f_x(x_0,y_0)\mathrm{d}x + f_y(x_0,y_0)\mathrm{d}y
$$

> 该定理同样适用于二元以上的函数.

需要注意, 若函数在 $(x_0,y_0)$ 的两个偏导数都存在, 不能推出其在 $(x_0,y_0)$ 出可微, 即:

$$
\frac{\partial z}{\partial x},\frac{\partial z}{\partial y}均存在
\centernot{\implies} z在(x_0,y_0)可微
$$


判断函数在某点不可微, 可以使用反证法. 
根据全微分的定义, 曲面可以表示为:

$$
\Delta z = f_x(0,0)\Delta x + f_y(0,0)\Delta y + o(\rho)
$$

进而可以推导:

$$
o(\rho) = \Delta z - f_x(0,0)\Delta x - f_y(0,0)\Delta y
$$

然后判断 $\displaystyle\lim_{\rho\to 0}o(\rho) = 0$ 是否成立, 若不成立, 则不满足可微的条件. 即随着 $(x,y)$ 不断接近 $(x_0,y_0)$ , 微分和曲面的差值并不是可以任意小.


## `定理124` $可微必连续$

> 已知函数 $z=f(x,y)$ , 若 $z=f(x,y)$ 在 $(x_0,y_0)$ 点可微分, 则 $z=f(x,y)$ 在 $(x_0,y_0)$ 点一定连续, 即:

$$
z=f(x,y)在(x_0,y_0)点{\color{red}可微} \implies z=f(x,y)在(x_0,y_0)点{\color{red}连续}
$$


## `定理125` $偏导连续必可微$

> 已知函数 $z=f(x,y)$ 的偏导数为 $\dfrac{\partial f}{\partial x}$ , $\dfrac{\partial f}{\partial y}$ , 则:

$$
\dfrac{\partial f}{\partial x},\dfrac{\partial f}{\partial x}在(x_0,y_0)点连续
\implies
z=f(x,y)在(x_0,y_0)点{\color{red}可微}
$$

需要重点注意的是, 偏导数存在, 需要从任意方向逼近 $(x_0,y_0)$ 点, 而不是只看 $x$ 方向和 $y$ 方向, 一个典型的反例是: $z=\sqrt{\left|xy\right|}$ .

上述定理反推不成立, 因为存在一些震荡的情况, 虽然可微, 但是偏导数因为在中心点极限不存在而不连续.


# 10.5 多元复合函数的求导法则

## `定理126` $全导数$

> 若函数 $x=\varphi(t)$ 及 $y=\psi(t)$ 都在 $t_0$ 处可导, 函数 $z=f(x,y)$ 在 $t=t_0$ 时有对应的 $(x_0,y_0)$ 点右连续的偏导数, 则复合函数 $z = f\Big(\varphi(t),\psi(t)\Big)$ 在 $t_0$ 点可导, 且有:

$$
\frac{\mathrm{d}z}{\mathrm{d}t} = 
\frac{\partial z}{\partial x} \frac{\mathrm{d}x}{\mathrm{d}t} + 
\frac{\partial z}{\partial y} \frac{\mathrm{d}y}{\mathrm{d}t}
$$

> 其中 $\dfrac{\mathrm{d}z}{\mathrm{d}t}$ 称为<font color=red><b>全导数</b></font>.

全导数的求解方法是将所有的可能路径的导数按链式法则求导后相加, 有些类似机器学习中的梯度下降中的求导.


## `定理127` $多元函数的复合$

> 若函数 $x=\varphi(s,t)$ 及 $y = \psi(s,t)$ 都在 $(s_0,t_0)$ 点具有对 $s$ 及对 $t$ 的偏导数, 函数 $z=f(x,y)$ 在 $t_0$ 点对应的 $(x_0,y_0)$ 点有连续的偏导数, 则复合函数 $z=f[\varphi(s,t),\psi(s,t)]$ 在 $(s_0,t_0)$ 点的两个偏导数都存在, 且有:

$$
\frac{\partial z}{\partial s} = 
\frac{\partial z}{\partial x} \frac{\partial x}{\partial s} +
\frac{\partial z}{\partial y} \frac{\partial y}{\partial s} ,\quad
\frac{\partial z}{\partial t} = 
\frac{\partial z}{\partial x} \frac{\partial x}{\partial t} +
\frac{\partial z}{\partial y} \frac{\partial y}{\partial t}
$$

上述定理也称为<font color=red><b>多元复合函数的求导法则</b></font>.

本质上是 $t$ 可以通过不同的路径最终影响到 $z$ . 这些不同的路径的影响效果是叠加而不是耦合的.
全微分的推导过程中可以知道微观尺度上, 总的变化量就是各个自变量独立变化所引起的效果的线性叠加, 而不存在其他耦合项. 在无穷小的尺度下, 高阶项可以忽略不计.

公式可以通过连锁反应获得, 对于 $z=f[\varphi(s,t),\psi(s,t)]$ , 以其中的 $t$ 为例: 
在**第一层**传递中: $t$ 的微小变化 $\Delta t$ 会引同时引起 $x$ 和 $y$ 的变化:

$$
\Delta x \approx \frac{\partial \varphi}{\partial t} \Delta t = \frac{\partial x}{\partial t} \Delta t ,
\quad
\Delta y \approx \frac{\partial \psi}{\partial t} \Delta t = \frac{\partial x}{\partial t} \Delta t
$$

在**第二层**传递中: $x$ 的微小变化 $\Delta x$ 和 $y$ 的微小变化 $\Delta y$ 会共同引起 $z$ 的变化:

$$
\Delta z \approx \frac{\partial z}{\partial x} \Delta x + \frac{\partial z}{\partial y} \Delta y
$$

将两层传递组合, 得到:

$$
\Delta z \approx 
\frac{\partial z}{\partial x} \Delta x + \frac{\partial z}{\partial y} \Delta y = 
\frac{\partial z}{\partial x} \frac{\partial x}{\partial t} \Delta t + \frac{\partial z}{\partial y} \frac{\partial x}{\partial t} \Delta t
$$

当 $\Delta t \to 0$ 时, 可写作精确地等式:

$$
\frac{\partial z}{\partial t} = 
\frac{\partial z}{\partial x} \frac{\partial x}{\partial t} +
\frac{\partial z}{\partial y} \frac{\partial y}{\partial t}
$$


# 10.6 微分与雅可比矩阵, 行列式

单变量, 多变量函数的微积分都可以写成矩阵乘法的形式, 例如 $y=f(x_1,x_2,\cdots,x_n)$ 的**微分**为:

$$
\mathrm{d}y = 
\frac{\partial y}{\partial x_1} \mathrm{d}x_1 + 
\frac{\partial y}{\partial x_2} \mathrm{d}x_2 + 
\cdots +
\frac{\partial y}{\partial x_n} \mathrm{d}x_n
$$

进一步可以写作向量的形式:

$$
\underset{\boldsymbol{\mathrm{d}y}}{\underbrace{\mathrm{d}y}} = 
\underset{\boldsymbol{T}}{
\underbrace{
\begin{pmatrix}
\displaystyle\frac{\partial y}{\partial x_1} &
\displaystyle\frac{\partial y}{\partial x_2} &
\cdots &
\displaystyle\frac{\partial y}{\partial x_n}
\end{pmatrix}}}
\underset{\boldsymbol{\mathrm{d}x}}{
\underbrace{
\begin{pmatrix}
\mathrm{d}x_1 \\
\mathrm{d}x_1 \\
\vdots \\
\mathrm{d}x_1
\end{pmatrix}}} 
\implies
\boldsymbol{\mathrm{d}y} = \boldsymbol{T}\boldsymbol{\mathrm{d}x}
$$

此外, 若空间中的两曲面有交线, 则交线的微分等于两个曲面微分的联立. 若空间曲面分别为: $z=f(x,y)$ 和 $z=g(x,y)$ , 则<font color=red><b>交线的微分</b></font>为:

$$
\left\{
\begin{array}{l}
\displaystyle \mathrm{d}z = \frac{\partial f}{\partial x} \mathrm{d} x + \frac{\partial f}{\partial y} \mathrm{d} y \\
\displaystyle \mathrm{d}z = \frac{\partial g}{\partial x} \mathrm{d} x + \frac{\partial g}{\partial y} \mathrm{d} y
\end{array}
\right.
$$

可以写作矩阵乘法的形式:

$$
\underset{\boldsymbol{\mathrm{d}y}}{\underbrace{
\begin{pmatrix}
\mathrm{d}z \\
\mathrm{d}z
\end{pmatrix}
}} = 
\underset{\boldsymbol{T}}{
\underbrace{
\begin{pmatrix}
\displaystyle\frac{\partial f}{\partial x} &
\displaystyle\frac{\partial f}{\partial y} \\
\displaystyle\frac{\partial g}{\partial x} &
\displaystyle\frac{\partial g}{\partial y}
\end{pmatrix}}}
\quad
\underset{\boldsymbol{\mathrm{d}x}}{
\underbrace{
\begin{pmatrix}
\mathrm{d}x \\
\mathrm{d}y
\end{pmatrix}}} 
\implies
\boldsymbol{\mathrm{d}y} = \boldsymbol{T}\boldsymbol{\mathrm{d}x}
$$


## `定义100` $雅可比矩阵$

> 假设 $f_1,f_2,\cdots,f_n$ 是 $x_1, x_2, \cdots, x_m$ 的函数, 且对各个自变量的偏导数都存在, 则定义如下函数矩阵:

$$
\boldsymbol{J}(x_1,x_2,\cdots,x_m) = 
\displaystyle\frac{\partial(f_1,f_2,\cdots,f_n)}{\partial(x_1,x_2,\cdots,x_m)} = 
\begin{pmatrix}
\displaystyle\frac{\partial f_1}{\partial x_1} & 
\displaystyle\frac{\partial f_1}{\partial x_2} & 
\cdots &
\displaystyle\frac{\partial f_1}{\partial x_m} \\
\displaystyle\frac{\partial f_2}{\partial x_1} & 
\displaystyle\frac{\partial f_2}{\partial x_2} & 
\cdots &
\displaystyle\frac{\partial f_2}{\partial x_m} \\
\vdots & \vdots & \ddots & \vdots \\
\displaystyle\frac{\partial f_n}{\partial x_1} & 
\displaystyle\frac{\partial f_n}{\partial x_2} & 
\cdots &
\displaystyle\frac{\partial f_n}{\partial x_m} \\
\end{pmatrix}
$$

> 该矩阵 $\boldsymbol{J}$ 称为<font color=red><b>雅可比矩阵</b></font>, 若为方阵, 则对应的行列式称为<font color=red><b>雅可比行列式</b></font>, 记作:

$$
|\boldsymbol{J}(x_1,x_2,\cdots,x_n)| = 
\left| \displaystyle\frac{\partial(f_1,f_2,\cdots,f_n)}{\partial(x_1,x_2,\cdots,x_n)} \right|= 
\begin{vmatrix}
\displaystyle\frac{\partial f_1}{\partial x_1} & 
\displaystyle\frac{\partial f_1}{\partial x_2} & 
\cdots &
\displaystyle\frac{\partial f_1}{\partial x_n} \\
\displaystyle\frac{\partial f_2}{\partial x_1} & 
\displaystyle\frac{\partial f_2}{\partial x_2} & 
\cdots &
\displaystyle\frac{\partial f_2}{\partial x_n} \\
\vdots & \vdots & \ddots & \vdots \\
\displaystyle\frac{\partial f_n}{\partial x_1} & 
\displaystyle\frac{\partial f_n}{\partial x_2} & 
\cdots &
\displaystyle\frac{\partial f_n}{\partial x_n} \\
\end{vmatrix}
$$

雅可比矩阵的每个元素都是偏导数.

雅可比矩阵有些类似一元函数的"导数". 可以用雅可比矩阵作为导数, 此时对于一元函数而言, 可以将 $\dfrac{\mathrm{d}f}{\mathrm{d}x}$ 看做一种特殊的偏导数, 此时便可以套用雅可比矩阵的形式.

对于多元函数而言, 其导数的形式是复杂的, 可微和可导并不是充要条件, 具体可以通过偏导数的连续性判断, 总而言之, 还是需要判断曲面是否圆滑无尖角.

雅可比矩阵的<font color=red><b>链式法则</b></font>:

> 复合函数的雅可比矩阵等于各个函数的雅可比矩阵的乘积.

一些函数种类的雅可比矩阵如下:

|     函数类型      |                                                                               函数原型                                                                                |                                                                                                                                                                                                                                                                                                                                                                                                             求导法则                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                      雅可比矩阵                                                                                      |
| :-----------: | :---------------------------------------------------------------------------------------------------------------------------------------------------------------: | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------: | :-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------: |
| $$单元+单元复合函数$$ |                                                           $$\begin{array}{c}y=f(x)\\x=x(t)\end{array}$$                                                           |                                                                                                                                                                                                                                                                                                                                                             $$\dfrac{\mathrm{d}y}{\mathrm{d}t} = \frac{\mathrm{d}y}{\mathrm{d}x}\frac{\mathrm{d}x}{\mathrm{d}t}$$                                                                                                                                                                                                                                                                                                                                                             |                                     $$\dfrac{\partial(y)}{\partial(t)} = \dfrac{\partial(f)}{\partial(x)}\dfrac{\partial(x)}{\partial(t)}$$                                     |
| $$多元+单元复合函数$$ |                           $$\begin{array}{c}y=f(x_1,x_2,\cdots,x_n)\\x_1 = x_1(t), \ x_2=x_2(t), \ \cdots, \ x_n = x_n(t)\end{array}$$                            |                                                                                                                                                                                                                                                                                    $$\dfrac{\mathrm{d}y}{\mathrm{d}t} = \dfrac{\partial y}{\partial x_1}\dfrac{\mathrm{d}x_1}{\mathrm{d}t}+\dfrac{\partial y}{\partial x_2}\dfrac{\mathrm{d}x_2}{\mathrm{d}t}+\cdots+\dfrac{\partial y}{\partial x_n}\dfrac{\mathrm{d}x_n}{\mathrm{d}t}$$                                                                                                                                                                                                                                                                                     |                  $$\dfrac{\partial (y)}{\partial (t)}=\dfrac{\partial (f)}{\partial (x_1,x_2,\cdots,x_n)}\dfrac{\partial (x_1,x_2,\cdots,x_n)}{\partial (t)}$$                  |
| $$多元+多元复合函数$$ | $$\begin{array}{c}y=f(x_1,x_2,\cdots,x_m)\\ \\x_1 = x_1(t_1,t_2,\cdots,t_n) \\ x_2=x_2(t_1,t_2,\cdots,t_n) \\ \vdots \\x_m = x_m(t_1,t_2,\cdots,t_n)\end{array}$$ | $$\begin{array}{c}\dfrac{\mathrm{d}y}{\mathrm{d}t_1} = \dfrac{\partial y}{\partial x_1}\dfrac{\mathrm{d}x_1}{\mathrm{d}t_1}+\dfrac{\partial y}{\partial x_2}\dfrac{\mathrm{d}x_2}{\mathrm{d}t_1}+\cdots+\dfrac{\partial y}{\partial x_n}\dfrac{\mathrm{d}x_m}{\mathrm{d}t_1}\\\dfrac{\mathrm{d}y}{\mathrm{d}t_2} = \dfrac{\partial y}{\partial x_1}\dfrac{\mathrm{d}x_1}{\mathrm{d}t_1}+\dfrac{\partial y}{\partial x_2}\dfrac{\mathrm{d}x_2}{\mathrm{d}t_2}+\cdots+\dfrac{\partial y}{\partial x_n}\dfrac{\mathrm{d}x_m}{\mathrm{d}t_2}\\ \vdots \\ \dfrac{\mathrm{d}y}{\mathrm{d}t_n} = \dfrac{\partial y}{\partial x_1}\dfrac{\mathrm{d}x_1}{\mathrm{d}t_n}+\dfrac{\partial y}{\partial x_2}\dfrac{\mathrm{d}x_2}{\mathrm{d}t_n}+\cdots+\dfrac{\partial y}{\partial x_n}\dfrac{\mathrm{d}x_m}{\mathrm{d}t_n} \end{array}$$ | $$\dfrac{\partial (y)}{\partial (t_1,t_2,\cdots,t_n)}=\dfrac{\partial (f)}{\partial (x_1,x_2,\cdots,x_m)}\dfrac{\partial (x_1,x_2,\cdots,x_m)}{\partial (t_1,t_2,\cdots,t_n)}$$ |

在使用雅可比矩阵的时候, 输入的自变量组通常写作列向量. 

因此, 在链式法则的使用过程中, 需要时刻注意某个函数的输入和输出数量, 借此便可判断矩阵的行列数. 
例如一个函数 $f(x,y,z)$ 输入变量为 $x,y,z$ , 输出变量为 $f$ . 则输入为 $3\times1$ 向量, 输出为 $1\times 1$ 向量. 套用到 $\boldsymbol{\mathrm{d}y} = \boldsymbol{J}\boldsymbol{\mathrm{d}x}$ 中, $\boldsymbol{J}$ 应该是 $3\times1$ 向量, 也就确定了雅可比矩阵的形式.


# 10.7 隐函数的求导公式

## `定理128` $隐函数存在定理1$

> 设函数 $F(x,y)$ 在 $(x_0,y_0)$ 点的某一邻域内有连续的偏导数, 且:

$$
F(x_0,y_0) = 0, \quad F_y(x_0,y_0) \neq 0
$$

> 则方程 $F(x,y)=0$ 在 $(x_0,y_0)$ 点的某一邻域内恒能唯一确定一个连续且具有连续导数的函数 $y=f(x)$ , 满足条件 $y_0 = f(x_0)$ , 并有:

$$
\dfrac{\mathrm{d}y}{\mathrm{d}x} = -\frac{F_x}{F_y}
$$

上述定理是将二维平面中的曲线作为三维空间曲线考虑, 能够将邻域从数轴, 转换到区域.

定理中要求在邻域范围内函数的值等于 $0$ . 并且邻域范围内对 $y$ 的偏导数均不为 $0$ , 该条件保证了微分不平行于 $y$ 轴, 满足函数的条件.

该定理可以通过微分平面理解, 微分平面过 $(x_0,y_0)$ 点.  
若 $y$ 的增量对 $z$ 没有贡献 (不能出现, 因为 $F_y\neq0$ ), 而 $x$ 的增量对 $z$ 起贡献, 此时平面在 $y$ 方向上的投影变成了曲线, 而不是曲面. 函数也就变成了 $z=f(x)$ 在 $xOy$ 平面上的交线是竖直的线.
若 $x$ 的增量对 $z$ 没有贡献, 而 $y$ 的增量对 $z$ 起贡献, 此时平面在 $x$ 方向上的投影变成了曲线, 而不是曲面. 函数也就变成了 $z=f(y)$ 在 $xOy$ 平面上的交线是水平的线.
当 $x$ 和 $y$ 都起作用, 微分平面介于以上两个效果之间, 当 $x$ 和 $y$ 都对 $z$ 的增量起正作用的时候, 可以想象到, 微分平面与 $xOy$ 的交线是一条负斜率的直线, 也就是公式中" $-$ "的来源. 而至于数值, 可以看到 $x$ 对 $z$ 的影响越大时, 交线越接近竖直, 而 $y$ 对 $z$ 的影响越大时, 交线越接近水平, 再通过代数可知, 应该是 $-\dfrac{F_x}{F_y}$ .

将以上定理推广到三元函数, 获得以下定理:


## `定理129` $隐函数存在定理2$

该定理描述的是在三维空间下的曲线

> 设函数 $F(x,y,z)$ 在 $(x_0,y_0,z_0)$ 点的某一邻域内有连续的偏导数, 且:

$$
F(x_0,y_0,z_0) = 0, \quad F_z(x_0,y_0,z_0) \neq 0
$$

> 则方程 $F(x,y,z)=0$ 在 $(x_0,y_0,z_0)$ 点的某一邻域内恒能唯一确定一个连续且具有连续导数的函数 $z=f(x,y)$ , 满足条件 $z_0 = f(x_0,y_0)$ , 并有:

$$
\dfrac{\partial z}{\partial x} = -\dfrac{F_x}{F_z},\quad
\dfrac{\partial z}{\partial y} = -\dfrac{F_y}{F_z}
$$


## `定理130` $隐函数存在定理3$

> 设 $F(x,y,u,v)$ 和 $G(x,y,u,v)$ 在 $(x_0,y_0,u_0,v_0)$ 点的某一邻域内有连续的偏导数, 满足:

$$
F(x_0,y_0,u_0,v_0) = 0,\quad
G(x_0,y_0,u_0,v_0) = 0
$$

> 且雅可比行列式:

$$
|\boldsymbol{J}(u,v)| = \left|\frac{\partial (F,G)}{\partial(u,v)}\right| = 
\begin{vmatrix}
F_u & F_v \\
G_u & G_v
\end{vmatrix}
$$

> 在 $(x_0,y_0,u_0,v_0)$ 点不等于 $0$ , 则方程组 $\left\{\begin{array}{l}F(x,y,u,v)=0\\ G(x,y,u,v)=0\end{array}\right.$ 在 $(x_0,y_0,u_0,v_0)$ 点的某一邻域内恒能唯一确定一组连续且具有连续导数的函数 $u=u(x,y)$ 和 $v=v(x,y)$ , 他们满足条件 $u_0 = u(x_0,y_0)$ 和 $v_0 = v(x_0,y_0)$ , 并有:

$$
\begin{array}{l}
\dfrac{\partial u}{\partial x} = 
-\dfrac{1}{|\boldsymbol{J}|}\left|\dfrac{\partial(F,G)}{\partial (x,v)}\right| = 
\displaystyle-\frac{\begin{vmatrix}F_x & F_v \\ G_x & G_v\end{vmatrix}}{\begin{vmatrix}F_u & F_v \\ G_u & G_v\end{vmatrix}}, \quad
\dfrac{\partial v}{\partial x} = 
-\dfrac{1}{|\boldsymbol{J}|}\left|\dfrac{\partial(F,G)}{\partial (u,x)}\right| = 
\displaystyle-\frac{\begin{vmatrix}F_u & F_x \\ G_u & G_x\end{vmatrix}}{\begin{vmatrix}F_u & F_v \\ G_u & G_v\end{vmatrix}} \\
\dfrac{\partial u}{\partial y} = 
-\dfrac{1}{|\boldsymbol{J}|}\left|\dfrac{\partial(F,G)}{\partial (y,v)}\right| = 
\displaystyle-\frac{\begin{vmatrix}F_y & F_v \\ G_y & G_v\end{vmatrix}}{\begin{vmatrix}F_u & F_v \\ G_u & G_v\end{vmatrix}}, \quad
\dfrac{\partial v}{\partial y} = 
-\dfrac{1}{|\boldsymbol{J}|}\left|\dfrac{\partial(F,G)}{\partial (u,y)}\right| = 
\displaystyle-\frac{\begin{vmatrix}F_u & F_y \\ G_u & G_y\end{vmatrix}}{\begin{vmatrix}F_u & F_v \\ G_u & G_v\end{vmatrix}}
\end{array}
$$


以上定理中的 $F$ 和 $G$ 分别是空间中的三维曲面. 
注意 $F$ 和 $G$ 实际上是 $F\Big(x,y,u(x,y),v(x,y)\Big) = 0$ 和 $G\Big(x,y,u(x,y),v(x,y)\Big) = 0$ . 有两个自由度, 因此是曲面.

定理中的 $\boldsymbol{J}(u,v)$ 表示该雅可比矩阵是相对变量 $u$ 和 $v$ 的.


## 三个隐函数存在定理的关系

三个隐函数求导定理是循序渐进的.

### 对于2元隐函数 (含2个自变量):

函数原型为 $\color{red}F(x,y) = 0$ . 可以看做是<font color=red><b>3维</b></font>曲面 $z = F(x,y)$ 和<font color=red><b>3维</b></font>平面 $z=0$ 的交线.
例如 $F(x,y)=x^2+y^2-1 = 0$ , 是3维曲面 $z = x^2+y^2-1$ 和3维平面 $z=0$ 的交线.

本质上,  $F(x,y) = 0$ 实际表示的是一个 $\color{red}1-流形$ (曲线), 且该曲线是一个二维曲线.

以 $\color{red}\dfrac{\partial y}{\partial x}$ 为例, 推导过程如下:

$$
\begin{array}{c}
F(x,y)=0 \\
\underset{\displaystyle\Downarrow}{_{等式两边对x求偏导数}} \\
\displaystyle\frac{\partial F}{\partial(x,y)}\frac{\partial (x,y)}{\partial x} = 
\displaystyle F_x+F_y\frac{\partial y}{\partial x} = 0 \\
\Downarrow \\
\displaystyle F_y\frac{\partial y}{\partial x} = - F_x 
\end{array}
$$

将上述等式看做关于 $\dfrac{\partial y}{\partial x}$ 的非齐次线性方程组, 其系数矩阵就是 $1\times1$ 的雅可比行列式. 根据克拉默法则计算 $\dfrac{\partial y}{\partial x}$ 的解:

$$
\displaystyle \frac{\partial y}{\partial x} = 
-\frac{\begin{vmatrix}F_x\end{vmatrix}}{\begin{vmatrix}F_y\end{vmatrix}} = 
-\frac{F_x}{F_y}
$$


### 对于3元隐函数 (含2个自变量):

函数原型为 $\color{red}F[x,y,z(x,y)] = 0$ . 可以看做是<font color=red><b>4维</b></font>面 $a = F(x,y,z)$ 和<font color=red><b>4维</b></font>中的体 $a=0$ 的交线.
由于实际还是只有两个自由度, 因此 $F$ 表示的是一个面.

本质上,  $F[x,y,z(x,y)] = 0$ 实际表示的是一个 $\color{red}1-流形$ (曲线).

以 $\color{red}\dfrac{\partial z}{\partial x}$ 为例, 推导过程如下:

$$
\begin{array}{c}
F[x,y,z(x,y)] = 0\\
\underset{\displaystyle\Downarrow}{_{等式两边对x求偏导数}} \\
\displaystyle\frac{\partial F}{\partial(x,z)}\frac{\partial (x,z)}{\partial x} = 
\displaystyle F_x+F_z\frac{\partial z}{\partial x} = 0 \\
\Downarrow \\
\displaystyle F_z\frac{\partial z}{\partial x} = - F_x 
\end{array}
$$

将上述等式看做关于 $\dfrac{\partial z}{\partial x}$ 的非齐次线性方程组, 其系数矩阵就是 $1\times1$ 的雅可比行列式. 根据克拉默法则计算 $\dfrac{\partial z}{\partial x}$ 的解:

$$
\displaystyle \frac{\partial z}{\partial x} = 
-\frac{\begin{vmatrix}F_x\end{vmatrix}}{\begin{vmatrix}F_z\end{vmatrix}} = 
-\frac{F_x}{F_z}
$$

$\color{red}\dfrac{\partial z}{\partial y}$ 同理.


### 对于两个4元隐函数 (含2个自变量):

函数原型为 $\color{red}F[x,y,u(x,y),v(x,y)] = 0$ 和 $\color{red}G[x,y,u(x,y),v(x,y)] = 0$ 联立. 
可以看做是<font color=red><b>5维</b></font>中的面 $a = F[x,y,u(x,y),v(x,y)]$ 和<font color=red><b>5维</b></font>中的4维流形 $a=0$ 的交, 结果是一个<font color=red><b>5维空间中的1维流形</b></font>. 
此外, 也可以不升高维度, 直接将 $F[x,y,u(x,y),v(x,y)] = 0$ 看做是一个4维空间中流形, 若将 $u$ 和 $v$ 首先不视作 $x$ 和 $y$ 的函数, 则  $F(x,y,u,v) = 0$ 作为一个隐函数, 表示的是一个<font color=red><b>4维</b></font>空间中的<font color=red><b>3维流形</b></font>.
在该隐函数存在定理中, 联立后的方程本质上相当于二元方程组. 4个未知数 + 2个限制条件, 剩余2个自由度, 能够确定一个<font color=red><b>2维流形</b></font>. 随机选取两个作为自变量,

以 $\color{red}\dfrac{\partial z}{\partial x}$ 为例, 推导过程如下:

$$
\begin{array}{c}
F[x,y,z(x,y)] = 0\\
\underset{\displaystyle\Downarrow}{_{等式两边对x求偏导数}} \\
\displaystyle\frac{\partial F}{\partial(x,z)}\frac{\partial (x,z)}{\partial x} = 
\displaystyle F_x+F_z\frac{\partial z}{\partial x} = 0 \\
\Downarrow \\
\displaystyle F_z\frac{\partial z}{\partial x} = - F_x 
\end{array}
$$

将上述等式看做关于 $\dfrac{\partial z}{\partial x}$ 的非齐次线性方程组, 其系数矩阵就是 $1\times1$ 的雅可比行列式. 根据克拉默法则计算 $\dfrac{\partial z}{\partial x}$ 的解:

$$
\displaystyle \frac{\partial z}{\partial x} = 
-\frac{\begin{vmatrix}F_x\end{vmatrix}}{\begin{vmatrix}F_z\end{vmatrix}} = 
-\frac{F_x}{F_z}
$$

$\color{red}\dfrac{\partial z}{\partial y}$ 同理.