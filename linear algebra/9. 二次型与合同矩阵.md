
# 9.1 二次型

## `定义1` $二次型$

> 关于一些变量的二次齐次多项式称为<font color=red><b>二次型</b></font> ( $Quadratic \ form$ ).

例如 $3x_1^2-7x_2^2$ , $3x_1^2+2x_2^2+4x_1x_2$ .

若多项式包含非二次项则不是二次型, 例如: $\underset{非二次项}{\underbrace{x_1^3-1}}+3x_1^2-7x_2^2$ , $3x_1^2+2x_2^2+4x_1x_2+\underset{非二次项}{\underbrace{x_1+x_2}}$ .

某些曲面和曲线等非线性对象可以借助二次型表示.

各类常见的二次曲线, 如**圆**, **椭圆**, **抛物线**, **双曲线**等都可以借助二次型表示.


## `定理1` $二次型矩阵$

> $f$ 是一个定义在 $\mathbb{R}^n$ 上的二次型, 它可以改写为:

$$
f=\boldsymbol{x}^T\boldsymbol{A}\boldsymbol{x}
$$

> 其中 $\boldsymbol{A}$ 是 $n\times n$ 的对称阵, 该矩阵 $\boldsymbol{A}$ 称为 $f$ 的<font color=red><b>二次型矩阵</b></font> ( $matrix\ of\ the\ quadratic\ form$ ).

定理中 $f$ 定义在 $\mathbb{R}^n$ 上, 意味着可以有 $n$ 个未知数, 而不是只能有 $x_1$ 和 $x_2$ .


求二次型矩阵的快捷方法举例:

求 $x_1^2-3x_3^2-4x_1x_2+x_2x_3$ , 该二次型有三个未知数, 对应 $\boldsymbol{x} = \begin{pmatrix}x_1\\x_2\\x_3\end{pmatrix}$ , 二次型矩阵 $\boldsymbol{A}$ 为 $3\times 3$ 矩阵.

先将二次型<font color=red><b>平分交叉项</b></font>, 将原二次型改写成如下形式:

$$
{\color{red}1}x_1^2{\color{green}-3}x_3^2{\color{yellow}-2}x_1x_2{\color{yellow}-2}x_1x_2+{\color{cyan}\frac{1}{2}}x_2x_3+{\color{cyan}\frac{1}{2}}x_2x_3
$$

将对应的系数填到矩阵对应交叉项的位置:

$$
\begin{array}{cc}
& \begin{matrix}x_1&x_2&x_3\end{matrix} \\
\begin{matrix}x_1\\x_2\\x_3\end{matrix} &
\begin{pmatrix}
{\color{red}1}&{\color{yellow}-2}&0 \\
{\color{yellow}-2}&0&{\color{cyan}\frac{1}{2}} \\
0&{\color{cyan}\frac{1}{2}}&{\color{green}-3} \\
\end{pmatrix}
\end{array}_{3\times3}
$$

<font color=red><b>二次型矩阵都是对称阵</b></font>.


# 9.2 合同矩阵

## 二次型和二次型矩阵的应用案例

使用二次型来求椭圆在进行旋转变换后的表达式.

若有椭圆 $\dfrac{x_1^2}{4}+ x_2^2 = 1$ , 旋转 $45\degree$ 后的表达式可通过如下步骤求得.
1. 将坐标系由原本的自然基, 变换到旋转后的基.
2. 按照原有椭圆表达式重新在新的坐标系下表达. (此处用到二次型矩阵)
3. 将新坐标系下的椭圆变换回自然基, 获得旋转后的表达式.

原本椭圆可以改写成 $\boldsymbol{x}^T\boldsymbol{A}\boldsymbol{x}$ , 其中:

$$
\boldsymbol{A} = 
\begin{pmatrix}
\frac{1}{4} & 0 \\
0 & 1
\end{pmatrix}, \quad
\boldsymbol{x} = 
\begin{pmatrix}
x_1 \\
x_2
\end{pmatrix}
$$

旋转矩阵为 $\begin{pmatrix}\cos\frac{\pi}{4} & -\sin\frac{\pi}{4}\\\sin\frac{\pi}{4} & \cos\frac{\pi}{4}\end{pmatrix}$ , 根据上述描述, 旋转后的二次型矩阵为:

$$
\boldsymbol{B} = (\boldsymbol{P}^{-1})^{T}\boldsymbol{A}\boldsymbol{P}^{-1} = 
\begin{pmatrix}
\frac{\sqrt{2}}{2} & -\frac{\sqrt{2}}{2} \\
\frac{\sqrt{2}}{2} & \frac{\sqrt{2}}{2}
\end{pmatrix}
\begin{pmatrix}
\frac{1}{4} & 0 \\
0 & 1
\end{pmatrix}
\begin{pmatrix}
\frac{\sqrt{2}}{2} & \frac{\sqrt{2}}{2} \\
-\frac{\sqrt{2}}{2} & \frac{\sqrt{2}}{2}
\end{pmatrix} = 
\begin{pmatrix}
\frac{5}{8} & -\frac{3}{8} \\
-\frac{3}{8} & \frac{5}{8}
\end{pmatrix}
$$

因此旋转后的椭圆表达式为 $\dfrac{5}{8}x_1^2 - \dfrac{3}{4}x_1x_2 + \dfrac{5}{8}x_2^2 = 1$ .


## `定义2` $合同与合同矩阵$

> 设 $\boldsymbol{A}$ 和 $\boldsymbol{B}$ 是 $n$ 阶方阵, 若有可逆矩阵 $\boldsymbol{P}$ , 使 $\boldsymbol{B} = \boldsymbol{P}^T\boldsymbol{A}\boldsymbol{P}$ , 则称 $\boldsymbol{A}$ 和 $\boldsymbol{B}$ <font color=red><b>合同</b></font> ( $Congruence$ ) , 称 $\boldsymbol{B}$ 是 $\boldsymbol{A}$ 的<font color=red><b>合同矩阵</b></font> ( $Matrix \ Congruence$ ).


## `定理2` $对称阵的合同矩阵也是对称阵$

> 若 $\boldsymbol{A}$ 是对称阵, 则其合同矩阵 $\boldsymbol{B}$ 也是对称阵.

对于二次型矩阵而言, 合同矩阵的集合意义就是对二次型进行坐标系变换. 合同矩阵定义中的 $\boldsymbol{P}$ 就是过度矩阵.


## 对于含有一次项的图形处理

二次曲线包含一次项时, 可以借助分块矩阵来处理, 如:

$$
\dfrac{5}{8}x_1^2 - \dfrac{3}{4}x_1x_2 + x_2^2 + \dfrac{1}{2}x_1 + 2x_2 = 1
$$

用分块矩阵表示为:

$$
\begin{pmatrix}
\boldsymbol{x}^T & 1
\end{pmatrix}
\begin{pmatrix}
\boldsymbol{A} & \boldsymbol{\alpha} \\
\boldsymbol{\alpha}^T & 0
\end{pmatrix}
\begin{pmatrix}
\boldsymbol{x}^T \\
1
\end{pmatrix}
= 1
$$

其中:

$$
\boldsymbol{A} = 
\begin{pmatrix}
\dfrac{5}{8} & -\dfrac{3}{8} \\
-\dfrac{3}{8} & 1
\end{pmatrix}, \quad
\boldsymbol{\alpha} = 
\begin{pmatrix}
\dfrac{1}{4} \\
1
\end{pmatrix}, \quad
\boldsymbol{x} = 
\begin{pmatrix}
x_1 \\
x_2
\end{pmatrix}
$$


## 合同变换与相似变换的区别

区别在于变换一个向量和变换一个二次型方程

<font color=green><b>相似变换</b></font>的形式为 $\boldsymbol{B} = \boldsymbol{P}^{-1}\boldsymbol{A}\boldsymbol{P}$ 

> 相似变换的对象是一个<font color=red><b>线性算子</b></font>的矩阵表示, 其解决的问题为: 
> "一个 `将向量v变换到向量w` 的线性变换, 在更换了一组坐标基之后, 这个变换的矩阵应该是什么?" 
> 这个过程中只涉及一个方向向量, 即 $\boldsymbol{w} = \boldsymbol{A}\boldsymbol{v}$ .


<font color=green><b>合同变换</b></font>的形式为 $\boldsymbol{B} = \boldsymbol{P}^{T}\boldsymbol{A}\boldsymbol{P}$ 

> 合同变换的对象是一个<font color=red><b>二次型</b></font>的矩阵表示, 其解决的问题为: 
> "一个 `描述点集` 的二次方程, 在换了一套坐标系后, 描述这个形状的方程矩阵应该是什么" 
> 二次型本身的表示形式即为 $f=\boldsymbol{x}^T\boldsymbol{A}\boldsymbol{x}$ . 注意, 这里的 $\boldsymbol{A}$ 不是变换, 而是二次型矩阵.

合同变换中转置的来源, 即合同变换过程:

1. 一个二次曲线由 $f=\boldsymbol{x}^T\boldsymbol{A}\boldsymbol{x}$ 描述.


2. 对坐标系变换相当于变换二次型中的基 $\boldsymbol{x}$ 

> 其关系为:

$$
\boldsymbol{x} = \boldsymbol{P} \boldsymbol{y}
$$
> 即新坐标左乘过渡矩阵, 就能变换为原坐标.


3. 代换方程, 在新的基中重新渲染二次曲线

> 重写方程 $f=\boldsymbol{x}^T\boldsymbol{A}\boldsymbol{x}$ , 将坐标变换带入:

$$
f={(\boldsymbol{P} \boldsymbol{y})}^T\boldsymbol{A}(\boldsymbol{P} \boldsymbol{y})
$$

> 将转置展开:

$$
f=\boldsymbol{y}^T\boldsymbol{P}^T\boldsymbol{A}\boldsymbol{P}\boldsymbol{y} = 
\boldsymbol{y}^T (\boldsymbol{P}^T\boldsymbol{A}\boldsymbol{P}) \boldsymbol{y}
$$


4. 获得中间的合同矩阵, 即:

$$
\boldsymbol{B}=\boldsymbol{P}^T\boldsymbol{A}\boldsymbol{P}
$$

如果直接理解, 则是将原本二次型中的坐标基替换.


# 9.3 合同对角化

合同对角化可以用来判断二次型表示的曲线.

本质上二元二次方程的图像只有两种, 一种是<font color=red><b>封闭曲线</b></font>, 即椭圆; 另一种是<font color=red><b>开放曲线</b></font>, 即双曲线.

进一步的, 圆锥曲线有如下细分类型:
- 椭圆, 圆: 当平面只与圆锥面一侧相交, 交截线是闭合曲线的时候, 且不过圆锥顶点, 结果为椭圆. 如果截面与圆锥面的对称轴垂直, 结果为圆.
- 抛物线: 截面仅与圆锥面的一条母线平行, 结果为抛物线.
- 双曲线: 截面与圆锥面两侧都相交, 且不过圆锥顶点, 结果为双曲线.

<p align = "central">
<img src = "/images/Conic_sections_with_plane.svg" width = "60%">
</p>

若要判定一个二元二次方程的图像类型, 需要**去除交叉项**. 合同矩阵只会对二次型进行坐标变换, 并不会改变曲线类型, 因此可以借助合同矩阵去除交叉项, 过程为:

$$
原二元二次方程
\xrightarrow {改写为二次型} 
\boldsymbol{x}^T\boldsymbol{A}\boldsymbol{x} = 1
\xrightarrow{合同矩阵} \boldsymbol{A}=\boldsymbol{P}^T\boldsymbol{\Lambda}\boldsymbol{P}
\xrightarrow{去除交叉项}
\boldsymbol{y}^T\boldsymbol{\Lambda}\boldsymbol{y} = 1
$$

对角化之后通过两个**二次项**的**系数符号**判断曲线类型, 若均为正, 则为椭圆, 若一正一负, 则为双曲线.


## `定义3` $标准形$

> 只含有平方项的二次型 $k_1x_1^2+k_2x_2^2+\cdots+k_nx_n^2$ 称为<font color=red><b>二次型的标准形</b></font> ( $Canonical \ form \ of \ a \ Quadratic$ ), 简称为标准形. 齐次二次型矩阵一定为 $n$ 阶对角阵:

$$
\boldsymbol{\Lambda} = 
\begin{pmatrix}
k_1 & 0 & \cdots & 0 \\
0 & k_2 & \cdots & 0 \\
\vdots & \vdots & \ddots & \vdots \\
0 & 0 & \cdots & k_n
\end{pmatrix}
$$


## 拉格朗日配方法

合同对角化可以使用正交合同对角化, 也可以使用<font color=red><b>拉格朗日配方法</b></font>:

1. 对于二次型中的平方项 $x_i^2$ , 将含有 $x_i$ 的项集中后配方.
2. 对于 $x_ix_j$ 且没有平方项 $x_i^2$ 或 $x_j^2$ , 进行函数换元:

$$
\left\{
\begin{array}{l}
x_i = y_i + y_j \\
x_j = y_i - y_j \\
x_k = y_k (k = 1,2,\cdots,n,k\neq i,j)
\end{array}
\right.
$$

上述操作会产生平方项, 回到 1. 中进行配方.
3. 重复 1. 和 2. 直至消除所有交叉项.

拉格朗日配方法的本质就是合同对角化. 使用了一个坐标变换矩阵:

$$
\begin{pmatrix}
1 & 1 \\
1 & -1 
\end{pmatrix}
$$


# 9.4 惯性定理与正负定

## `定理3` $惯性定理$

> 对于某二次型 $f$ , 可化为多个标准形. 这些标准形共同的特点为: 
> 正系数的个数 (也称为<font color=red><b>正惯性指数</b></font>, $Positive \ index \ of \ inertia$ ), 
> 负系数的个数 (也称为<font color=red><b>负惯性指数</b></font>, $Negative \ index \ of \ inertia$ ), 
> 以及零系数的个数均相同.
> 该定理称为<font color=red><b>西尔维斯特惯性定理</b></font> ( $Sylvester's \ law \ of \ inertia$ ), 简称为<font color=red><b>惯性定理</b></font>.

注意, 并非 $正惯性指数 = 负惯性指数 = 零系数$ , 而是化为的不同的标准型之间, 正负零系数个数相同.

可以通过惯性定理定义二次曲线的类型, 比如, 等号常数侧为 $1$ 时:
- 椭圆的正惯性指数为 $2$ .
- 双曲线的正惯性指数为 $1$ , 负惯性指数也为 $1$ .

三维的二次曲面也可以通过惯性定理来定义. 若等号常数侧为 $1$ , 则:
- 椭球面的正惯性指数为 $3$ . (.$\dfrac{x^2}{a^2}+\dfrac{y^2}{b^2}+\dfrac{z^2}{c^2} = 1$ )
- 单叶双曲面的正惯性指数为 $2$ , 负惯性指数为 $1$ . ( $\dfrac{x^2}{a^2}+\dfrac{y^2}{b^2}-\dfrac{z^2}{c^2} = 1$ )
- 双叶双曲面的正惯性指数为 $1$ , 负惯性指数为 $2$ . ( $-\dfrac{x^2}{a^2}-\dfrac{y^2}{b^2}+\dfrac{z^2}{c^2} = 1$ )


## `定义4` $正定与负定$

> 设二次型 $f(\boldsymbol{x})=\boldsymbol{x}^T\boldsymbol{A}\boldsymbol{x}$ , 则它是:

- <font color=red><b>正定</b></font> ( $Positive \ definite$ ) 的, 若对所有的 $\boldsymbol{x}\neq\boldsymbol{0}$ , 有 $f(\boldsymbol{x})>0$ .
- <font color=red><b>半正定</b></font> ( $Positive \ semidefinite$ ) 的, 若始终有 $f(\boldsymbol{x})\geq0$ .
- <font color=red><b>负定</b></font> ( $Negative \ definite$ ) 的, 若对所有的 $\boldsymbol{x}\neq\boldsymbol{0}$ , 有 $f(\boldsymbol{x})<0$ .
- <font color=red><b>半负定</b></font> ( $Negative \ semidefinite$ ) 的, 若始终有 $f(\boldsymbol{x})\leq0$ .
- <font color=red><b>不定</b></font> ( $Indefinite$ ) 的, 若 $f(\boldsymbol{x})$ 既有正值又有负值.


## `定理4` 维尔茨定理

> <font color=red><b>维尔茨定理</b></font> ( $Hurwitz \ theorem$ ):
> 已知二次型 $f(\boldsymbol{x})=\boldsymbol{x}^T\boldsymbol{A}\boldsymbol{x}$ , 其正定的充分必要条件为: $\boldsymbol{A}$ 的各阶主子式都为正, 即:

$$
a_{11} > 0, \quad
\begin{vmatrix}
a_{11} & a_{12} \\
a_{21} & a_{22} 
\end{vmatrix} > 0, \quad \cdots, \quad
\begin{vmatrix}
a_{11} & \cdots & a_{1n} \\
\vdots & \ddots & \vdots \\
a_{n1} & \cdots & a_{nn} 
\end{vmatrix} > 0
$$

> 其负定的充分必要条件为: 奇数阶主子式为负, 偶数阶主子式为正, 即:

$$
(-1)^r
\begin{vmatrix}
a_{11} & \cdots & a_{1r} \\
\vdots & \ddots & \vdots \\
a_{r1} & \cdots & a_{rr} 
\end{vmatrix} > 0, \quad (r=1,2,\cdots,n)
$$

